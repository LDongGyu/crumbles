<div class="search-wrap">
    <% count = 0 %>

    <p>빵집에서 <%= @search_itm %>(으)로 검색한 결과입니다.</p></br>

    <p>빵집 이름 : <%= @bakery_info.name %></p>
    <p>빵집 주소 : <%= @bakery_info.address %></p>
    <p>빵집 번호 : <%= @bakery_info.telephone_number %></p>
    <p>빵집 이메일 : <%= @bakery_info.email %></p>
    <p>빵집 오픈시간 : <%= @bakery_info.open_time %></p>
    <p>빵집 닫는시간 : <%= @bakery_info.close_time %></p>
    <p>빵집 좌석수 : <%= @bakery_info.seat %></p>
    <%= image_tag 'bakery.jpg' %>
    <div id="map" style="width:300px;height:200px;"></div>
    </br></br>

<div class="search-bread-list">
    <p>이 집의 따끈따끈 대표 빵들</p></br>
        <% @bakery_search_result.each do |result| %>
            <% count += 1 %>
            <section class="bread-item">
                <div class = "item">
                    <button class="collapsible">
                        <%= count %>번 빵
                        <ul>
                            <li><%= image_tag 'scon.png' %></li>
                            <li>
                                <p> 빵집 : <%= result.bakery_name %></p>
                                <p> 빵 이름 : <%= result.bread_name %></p>
                            </li>
                        </ul>
                    </button>
                    <div class = "content">
                        <p> 빵 종류 : <%= result.category %></p>
                        <p> 잔여 개수 : <%= result.amount %></p>
                        <p> 예약 가능 : <%= result.bookable_num %></p>
                        <p> 가격 : <%= result.price %></p>
                        <p> 별점 : <%= result.star_point %></p>
                        <a href = "/detail_item/index/<%=result.bread_name%>">빵 더보기...</a>
                        </br>
                    </div>
                </div>
            </section>
        <% end %>


    <script>
        var item = document.getElementsByClassName("collapsible");
        var i;

        for (i = 0; i < item.length; i++) {
        item[i].addEventListener("click", function() {
            this.classList.toggle("active");
            var content = this.nextElementSibling;
            if (content.style.maxHeight){
                content.style.maxHeight = null;
            }
            else {
            content.style.maxHeight = content.scrollHeight + "px";
            } 
        });
        }
    </script>

    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=1aff35522df41932aff1641ceb4b8039&libraries=services"></script>

    <script>
    var mapContainer = document.getElementById('map'), // 지도를 표시할 div 
        mapOption = {
            center: new daum.maps.LatLng(33.450701, 126.570667), // 지도의 중심좌표
            level: 3 // 지도의 확대 레벨
        };  
    // 지도를 생성합니다    
    var map = new daum.maps.Map(mapContainer, mapOption); 
    // 주소-좌표 변환 객체를 생성합니다
    var geocoder = new daum.maps.services.Geocoder();
    // 주소로 좌표를 검색합니다
    geocoder.addressSearch("<%= @bakery_info.address %>", function(result, status) {
        // 정상적으로 검색이 완료됐으면 
        if (status === daum.maps.services.Status.OK) {
            var coords = new daum.maps.LatLng(result[0].y, result[0].x);
            // 결과값으로 받은 위치를 마커로 표시합니다
            var marker = new daum.maps.Marker({
                map: map,
                position: coords
            });
            // 인포윈도우로 장소에 대한 설명을 표시합니다
            var infowindow = new daum.maps.InfoWindow({
                content: '<div style="width:150px;text-align:center;padding:6px 0;"><%= @bakery_info.name %></div>'
            });
            infowindow.open(map, marker);
            // 지도의 중심을 결과값으로 받은 위치로 이동시킵니다
            map.setCenter(coords);
        } 
    });    
    </script>
</div>